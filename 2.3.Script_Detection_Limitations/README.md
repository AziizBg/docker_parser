## Limitation 2.3 — Script Detection (Enhanced)

This enhancement improves script detection in RUN/CMD/ENTRYPOINT beyond simple file-extension checks and exact path matching.

### What’s included
- Enhanced parser: `Dockerfile_EAST_enhanced_scripts.py`
  - Detects script executions when invoked via interpreters (e.g., `bash /path/script.sh`)
  - Detects direct script execution with arguments (e.g., `/path/script.sh arg1 arg2`)
  - Detects execution of extensionless scripts made executable in the same RUN (e.g., `chmod +x /tmp/setup && /tmp/setup`)
  - Resolves relative paths using `WORKDIR` (e.g., `./script.sh`)
  - Maps `COPY/ADD` destinations to repository files to optionally extract script content
  - Uses shebang detection to treat extensionless files as scripts
- Comparison test suite: `COMPREHENSIVE_TEST_SUITE.py`
  - Prints the RUN subtrees for both the original and enhanced parsers
  - Highlights detected `script` nodes, their paths, args, and whether content was extracted

### How to run
```bash
python3 COMPREHENSIVE_TEST_SUITE.py | tee comprehensive_test.log
```

### Scenarios now handled
- COPY without extension + chmod + execute:
  - `COPY setup /tmp/` then `RUN chmod +x /tmp/setup && /tmp/setup`
- Interpreter-invoked scripts:
  - `RUN bash /tmp/script.sh`
- Direct script execution with arguments:
  - `RUN /tmp/script.sh arg1 arg2`
- Relative path scripts with WORKDIR:
  - `WORKDIR /app` then `RUN ./script.sh`

### Why this matters
- Real-world Dockerfiles often execute helper scripts without extensions, pass arguments, or use explicit interpreters. Detecting these reliably enables better security and compliance analysis (e.g., flagging unverified downloads or privileged operations inside scripts).

### Remaining limitations
- Cross-RUN chmod tracking is not implemented (chmod considered only within the same RUN).
- When `COPY --from=stage` sources are used, repository content cannot be extracted (no mapping to local files).
- Tokenization is heuristic and does not fully emulate shell parsing for all edge cases.

### File list
- `Dockerfile_EAST_enhanced_scripts.py` — enhanced parser
- `COMPREHENSIVE_TEST_SUITE.py` — old vs enhanced comparison runner
- `comprehensive_test.log` — optional log generated by running the suite

